!function(t){"use strict";const e=fcrc_analytics_params||{};var a={addQueryParam:function(t,e){var a=new URL(window.location.href);a.searchParams.set(t,e),window.history.pushState({},"",a)},getParamByName:function(t){let e=window.location.href;t=t.replace(/[\[\]]/g,"\\{text}");let a=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},selectPeriodFilter:function(){let e=a.getParamByName("period");e?t(`.period-filter-item[data-period="${e}"]`).addClass("active"):t(".period-filter-item").first().addClass("active"),t(document).on("click",".period-filter-item",(function(e){e.preventDefault();let r=t(this),c=t(this).data("period");t(".period-filter-item").removeClass("active"),t(".fcrc-analytics-widget").addClass("placeholder-content"),r.addClass("active"),a.addQueryParam("period",c),a.fetchData(c)}))},fetchData:function(r){t.ajax({url:e.ajax_url,type:"POST",dataType:"json",data:{action:"fcrc_get_analytics_data",period:r},success:function(e){if(e.success){t(".fcrc-analytics-widget").removeClass("placeholder-content"),t(".fcrc-analytics-container-item.get-total-recovered").html(e.data.total_recovered_widget),a.recoveredTotalChart(e.data.recovered_chart.labels,e.data.recovered_chart.series);const r=t(".fcrc-analytics-container-item.get-cart-status");r.html(e.data.cart_statuses_widget),r.find(".fcrc-carts-group-item.shopping").children(".fcrc-cart-item-title").html(e.data.counts.shopping),r.find(".fcrc-carts-group-item.abandoned").children(".fcrc-cart-item-title").html(e.data.counts.abandoned),r.find(".fcrc-carts-group-item.recovered").children(".fcrc-cart-item-title").html(e.data.counts.recovered),r.find(".fcrc-carts-group-item.lost").children(".fcrc-cart-item-title").html(e.data.counts.lost),r.find(".fcrc-carts-group-item.leads").children(".fcrc-cart-item-title").html(e.data.counts.lead),r.find(".fcrc-carts-group-item.order_abandoned").children(".fcrc-cart-item-title").html(e.data.counts.order_abandoned),t(".fcrc-analytics-container-item.sent-notifications").html(e.data.notifications_chart_widget),a.sentNotificationsChart(e.data.notifications_chart.categories,e.data.notifications_chart.series)}},error:function(){console.error("Error on load analytics data from backend")}})},recoveredTotalChart:function(t,r){const c={chart:{type:"line",height:320,toolbar:{show:!1}},stroke:{curve:"smooth",width:3},series:[{name:e.i18n.total_recovered,data:r}],xaxis:{categories:t,labels:{style:{fontSize:"13px"}}},yaxis:{labels:{formatter:function(t){return a.formatCurrency(t)}}},tooltip:{y:{formatter:function(t){return a.formatCurrency(t)}}}};this.totalChart=new ApexCharts(document.querySelector("#fcrc-recovered-chart"),c),this.totalChart.render()},sentNotificationsChart:function(t,a){const r={chart:{type:"bar",height:320,toolbar:{show:!1}},series:a.map((t=>({name:t.name,data:t.data}))),xaxis:{categories:t,labels:{style:{fontSize:"13px"}}},yaxis:{title:{text:e.i18n.notifications_chart}},tooltip:{y:{formatter:t=>String(t)}}};this.sentChart=new ApexCharts(document.querySelector("#fcrc_sent_notifications_chart"),r),this.sentChart.render()},formatCurrency:function(t){const a=e.currency||{},r=a.symbol||"R$",c=a.position||"left",i=a.decimal_separator||",",o=a.thousand_separator||".",n=void 0===a.decimals?2:a.decimals;let s=parseFloat(t).toFixed(n).toString().split("."),d=s[0].replace(/\B(?=(\d{3})+(?!\d))/g,o)+(s[1]?i+s[1]:"");switch(c){case"left":default:return r+d;case"right":return d+r;case"left_space":return r+" "+d;case"right_space":return d+" "+r}},init:function(){this.selectPeriodFilter();let t=a.getParamByName("period")||7;this.fetchData(t)}};jQuery(document).ready((function(t){a.init()}))}(jQuery);
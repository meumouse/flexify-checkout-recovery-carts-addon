!function(t){"use strict";const e=fcrc_settings_params,o={init:function(){this.activateTabs(),this.saveOptions(),this.addNewFollowUp(),this.editFollowUp(),this.deleteFollowUp(),this.collectLeadSettings()},activateTabs:function(){t(document).ready((function(){let e=window.location.hash,o=localStorage.getItem("fc_recovery_carts_get_admin_tab_index");if(e){let o=t('.fc-recovery-carts-wrapper a.nav-tab[href="'+e+'"]');o.length&&o.click()}else null!==o?t(".fc-recovery-carts-wrapper a.nav-tab").eq(o).click():t('.fc-recovery-carts-wrapper a.nav-tab[href="#general"]').click()})),t(document).on("click",".fc-recovery-carts-wrapper a.nav-tab",(function(){let e=t(this).index();localStorage.setItem("fc_recovery_carts_get_admin_tab_index",e);let o=t(this).attr("href");return t(".fc-recovery-carts-wrapper a.nav-tab").removeClass("nav-tab-active"),t(".fc-recovery-carts-form .nav-content").removeClass("active"),t(this).addClass("nav-tab-active"),t(".fc-recovery-carts-form").find(o).addClass("active"),!1}))},displayToast:function(o,a,s){var n="",l="",c="";"success"===o?(n="toast-success",l="bg-success text-white",c='<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg>'):"error"===o?(n="toast-danger",l="bg-danger text-white",c='<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg>'):"warning"===o?(n="toast-warning",l="bg-warning text-white",c='<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg>'):(n="toast-secondary",l="bg-secondary text-white",c="");var i="toast-"+Math.random().toString(36).substr(2,9),r=`<div id="${i}" class="toast ${n} show">\n\t\t\t\t<div class="toast-header ${l}">\n\t\t\t\t\t\t${c}\n\t\t\t\t\t\t<span class="me-auto">${a}</span>\n\t\t\t\t\t\t<button class="btn-close btn-close-white ms-2 hide-toast" type="button" data-bs-dismiss="toast" aria-label="${e.i18n.toast_aria_label}"></button>\n\t\t\t\t</div>\n\t\t\t\t<div class="toast-body">${s}</div>\n\t\t\t</div>`;t(".fc-recovery-carts-wrapper").before(r),setTimeout((()=>{jQuery("#"+i).fadeOut("fast")}),3e3),setTimeout((()=>{jQuery("#"+i).remove()}),3500),t(document).on("click",".hide-toast",(function(){var e=t(".toast.show").attr("id");t("#"+e).fadeOut("fast"),setTimeout((function(){t("#"+e).remove()}),500)}))},displayModal:function(e,o,a){const s="string"==typeof e?e:"#"+e.attr("id"),n="string"==typeof o?o:"#"+o.attr("id"),l="string"==typeof a?a:"#"+a.attr("id");t(document).on("click",s,(function(e){e.preventDefault(),t(n).addClass("show")})),t(document).on("click",n,(function(e){e.target===this&&t(this).removeClass("show")})),t(document).on("click",l,(function(e){e.preventDefault(),t(n).removeClass("show")}))},keepButtonState:function(t){var e=t.width(),o=t.height(),a=t.html();return t.width(e),t.height(o),{width:e,height:o,html:a}},saveOptions:function(){let a=t('form[name="fc-recovery-carts-options-form"]'),s=a.serialize();t("#fcrc_save_options").on("click",(function(n){n.preventDefault();let l=t(this),c=o.keepButtonState(l);t.ajax({url:e.ajax_url,type:"POST",data:{action:"fc_recovery_carts_save_options",form_data:a.serialize()},beforeSend:function(){l.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(t){e.debug_mode&&console.log(t);try{"success"===t.status&&(s=a.serialize(),o.displayToast("success",t.toast_header_title,t.toast_body_title))}catch(t){console.log(t)}},error:function(t,e,o){console.error("AJAX Error:",e,o)},complete:function(){l.html(c.html)}})})),a.on("change input","input, select, textarea",(function(){a.serialize()!==s?t("#fcrc_save_options").prop("disabled",!1):t("#fcrc_save_options").prop("disabled",!0)}))},addNewFollowUp:function(){let a=t("#fcrc_add_new_follow_up_container");o.displayModal(t("#fcrc_add_new_follow_up_trigger"),a,t("#fcrc_add_new_follow_up_close")),t(document).on("click","#fcrc_add_new_follow_up_save",(function(a){a.preventDefault();let s=t(this),n=o.keepButtonState(s),l=t("#fcrc_add_new_follow_up_title"),c=t("#fcrc_add_new_follow_up_message"),i=t("#fcrc_add_new_follow_up_delay_time"),r=t("#fcrc_add_new_follow_up_delay_type"),d=t("#fcrc_add_new_follow_up_channels_whatsapp");t.ajax({url:e.ajax_url,type:"POST",data:{action:"fcrc_add_new_follow_up",title:l.val(),message:c.val(),delay_time:i.val(),delay_type:r.val(),whatsapp:d.prop("checked")?"yes":"no",email:""},beforeSend:function(){s.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){try{"success"===e.status?(t("#follow_up").find("ul.fcrc-follow-up-list").replaceWith(e.follow_up_list),t("#fcrc_add_new_follow_up_container").removeClass("show"),o.displayToast("success",e.toast_header_title,e.toast_body_title),l.val(""),c.val(""),i.val(""),r.val(""),d.prop("checked",!1)):o.displayToast("error",e.toast_header_title,e.toast_body_title)}catch(t){console.log(t)}},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)},complete:function(){s.prop("disabled",!1).html(n.html)}})}))},editFollowUp:function(){t(document).on("click",".edit-follow-up-item",(function(e){e.preventDefault();var o=t(this),a=o.siblings(".edit-follow-up-container"),s=o.siblings(".edit-follow-up-close");t("#"+a.attr("id")).addClass("show"),t(document).on("click","#"+a.attr("id"),(function(e){e.target===this&&t(this).removeClass("show")})),t(document).on("click","#"+s.attr("id"),(function(e){e.preventDefault(),t("#"+a.attr("id")).removeClass("show")}))})),t(document).on("change keyup input",".get-follow-up-title",(function(){let e=t(this).val();var o=t(".edit-follow-up-container.show").data("follow-up-item");console.log(o),t('.list-group-item[data-follow-up-item="'+o+'"]').find(".fcrc-follow-up-item-title").text(e)}))},deleteFollowUp:function(){t(document).on("click",".delete-follow-up-item",(function(a){a.preventDefault();var s=t(this),n=o.keepButtonState(s),l=s.data("follow-up-item");confirm(e.i18n.confirm_delete_follow_up)&&t.ajax({url:e.ajax_url,type:"POST",data:{action:"fcrc_delete_follow_up",event_key:l},beforeSend:function(){s.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){try{"success"===e.status?(t("#follow_up").find("ul.fcrc-follow-up-list").replaceWith(e.follow_up_list),o.displayToast("success",e.toast_header_title,e.toast_body_title)):o.displayToast("error",e.toast_header_title,e.toast_body_title)}catch(t){console.log(t)}},error:function(t,e,o){console.error("Error on AJAX request:",t.responseText)},complete:function(){s.prop("disabled",!1).html(n.html)}})}))},visibilityController:function(e,o){let a=t(e).prop("checked");t(o).toggleClass("d-none",!a),t(e).on("click",(function(){a=t(this).prop("checked"),t(o).toggleClass("d-none",!a)}))},collectLeadSettings:function(){o.visibilityController("#enable_modal_add_to_cart","#collect_lead_modal_settings_trigger"),o.displayModal("#collect_lead_modal_settings_trigger","#collect_lead_modal_settings_container","#collect_lead_modal_settings_close")}};jQuery(document).ready((function(t){o.init()}))}(jQuery);
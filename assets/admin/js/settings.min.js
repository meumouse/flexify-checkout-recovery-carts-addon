!function(e){"use strict";const t=fcrc_settings_params||{},o={activateTabs:function(){e(document).ready((function(){let t=window.location.hash,o=localStorage.getItem("fc_recovery_carts_get_admin_tab_index");if(t){let o=e('.fc-recovery-carts-wrapper a.nav-tab[href="'+t+'"]');o.length&&o.click()}else null!==o?e(".fc-recovery-carts-wrapper a.nav-tab").eq(o).click():e('.fc-recovery-carts-wrapper a.nav-tab[href="#general"]').click()})),e(document).on("click",".fc-recovery-carts-wrapper a.nav-tab",(function(){let t=e(this).index();localStorage.setItem("fc_recovery_carts_get_admin_tab_index",t);let o=e(this).attr("href");return e(".fc-recovery-carts-wrapper a.nav-tab").removeClass("nav-tab-active"),e(".fc-recovery-carts-form .nav-content").removeClass("active"),e(this).addClass("nav-tab-active"),e(".fc-recovery-carts-form").find(o).addClass("active"),!1}))},displayToast:function(o,n,i){var s="",a="",l="";"success"===o?(s="toast-success",a="bg-success text-white",l='<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M9.999 13.587 7.7 11.292l-1.412 1.416 3.713 3.705 6.706-6.706-1.414-1.414z"></path></svg>'):"error"===o?(s="toast-danger",a="bg-danger text-white",l='<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg>'):"warning"===o?(s="toast-warning",a="bg-warning text-white",l='<svg class="icon icon-white me-2" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.486 2 2 6.486 2 12s4.486 10 10 10 10-4.486 10-10S17.514 2 12 2zm0 18c-4.411 0-8-3.589-8-8s3.589-8 8-8 8 3.589 8 8-3.589 8-8 8z"></path><path d="M11 11h2v6h-2zm0-4h2v2h-2z"></path></svg>'):(s="toast-secondary",a="bg-secondary text-white",l="");var r="toast-"+Math.random().toString(36).substr(2,9),c=`<div id="${r}" class="toast ${s} show">\n\t\t\t\t<div class="toast-header ${a}">\n\t\t\t\t\t\t${l}\n\t\t\t\t\t\t<span class="me-auto">${n}</span>\n\t\t\t\t\t\t<button class="btn-close btn-close-white ms-2 hide-toast" type="button" data-bs-dismiss="toast" aria-label="${t.i18n.toast_aria_label}"></button>\n\t\t\t\t</div>\n\t\t\t\t<div class="toast-body">${i}</div>\n\t\t\t</div>`;e(".fc-recovery-carts-wrapper").before(c),setTimeout((()=>{jQuery("#"+r).fadeOut("fast")}),3e3),setTimeout((()=>{jQuery("#"+r).remove()}),3500),e(document).on("click",".hide-toast",(function(){var t=e(".toast.show").attr("id");e("#"+t).fadeOut("fast"),setTimeout((function(){e("#"+t).remove()}),500)}))},displayModal:function(t,o,n){const i="string"==typeof t?t:"#"+t.attr("id"),s="string"==typeof o?o:"#"+o.attr("id"),a="string"==typeof n?n:"#"+n.attr("id");e(document).on("click",i,(function(t){t.preventDefault(),e(s).addClass("show")})),e(document).on("click",s,(function(t){t.target===this&&e(this).removeClass("show")})),e(document).on("click",a,(function(t){t.preventDefault(),e(s).removeClass("show")}))},keepButtonState:function(e){var t=e.width(),o=e.height(),n=e.html();return e.width(t),e.height(o),{width:t,height:o,html:n}},saveOptions:function(){let n=e('form[name="fc-recovery-carts-options-form"]'),i=n.serialize();e("#fcrc_save_options").on("click",(function(s){s.preventDefault();let a=e(this),l=o.keepButtonState(a);e.ajax({url:t.ajax_url,type:"POST",data:{action:"fc_recovery_carts_save_options",form_data:n.serialize()},beforeSend:function(){a.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(e){t.debug_mode&&console.log(e);try{"success"===e.status&&(i=n.serialize(),o.displayToast("success",e.toast_header_title,e.toast_body_title))}catch(e){console.log(e)}},error:function(e,t,o){console.error("AJAX Error:",t,o)},complete:function(){a.html(l.html)}})})),n.on("change input","input, select, textarea",(function(){n.serialize()!==i?e("#fcrc_save_options").prop("disabled",!1):e("#fcrc_save_options").prop("disabled",!0)}))},addNewFollowUp:function(){var n=e("#fcrc_add_new_follow_up_container");o.displayModal(e("#fcrc_add_new_follow_up_trigger"),n,e("#fcrc_add_new_follow_up_close")),e(document).on("click","#fcrc_add_new_follow_up_save",(function(i){i.preventDefault();let s=e(this),a=o.keepButtonState(s),l=e("#fcrc_add_new_follow_up_title"),r=e("#fcrc_add_new_follow_up_message"),c=e("#fcrc_add_new_follow_up_delay_time"),p=e("#fcrc_add_new_follow_up_delay_type"),d=e("#fcrc_add_new_follow_up_channels_whatsapp");var u={enabled:n.find(".enable-send-coupon").prop("checked")?"yes":"no",generate_coupon:n.find(".enable-generate-coupon").prop("checked")?"yes":"no",coupon_prefix:n.find(".get-coupon-prefix").val()||"",coupon_code:n.find(".get-coupon-code").val()||"",discount_type:n.find(".get-coupon-type").val()||"",discount_value:n.find(".get-coupon-value").val()||"",allow_free_shipping:n.find(".get-coupon-allow-free-shipping").prop("checked")?"yes":"no",expiration_time:n.find(".get-coupon-expire-time").val()||"",expiration_time_unit:n.find(".get-coupon-expire-time-type").val()||"",limit_usages:n.find(".get-coupon-limit-usage").val()||"",limit_usages_per_user:n.find(".get-coupon-limit-usage-per-user").val()||""};e.ajax({url:t.ajax_url,type:"POST",data:{action:"fcrc_add_new_follow_up",title:l.val()||"",message:r.val()||"",delay_time:c.val()||"",delay_type:p.val()||"",whatsapp:d.prop("checked")?"yes":"no",email:"",coupon:JSON.stringify(u)},beforeSend:function(){s.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(t){try{"success"===t.status?(e("#follow_up").find("ul.fcrc-follow-up-list").replaceWith(t.follow_up_list),o.emojiPicker(),e("#fcrc_add_new_follow_up_container").removeClass("show"),o.displayToast("success",t.toast_header_title,t.toast_body_title),l.val(""),r.val(""),c.val(""),p.val(""),d.prop("checked",!1)):o.displayToast("error",t.toast_header_title,t.toast_body_title)}catch(e){console.log(e)}},error:function(e,t,o){console.error("Error on AJAX request:",e.responseText)},complete:function(){s.prop("disabled",!1).html(a.html)}})}))},editFollowUp:function(){e(document).on("click",".edit-follow-up-item",(function(t){t.preventDefault();var o=e(this),n=o.siblings(".edit-follow-up-container"),i=o.siblings(".edit-follow-up-close");e("#"+n.attr("id")).addClass("show"),e(document).on("click","#"+n.attr("id"),(function(t){t.target===this&&e(this).removeClass("show")})),e(document).on("click","#"+i.attr("id"),(function(t){t.preventDefault(),e("#"+n.attr("id")).removeClass("show")}))})),e(document).on("change keyup input",".get-follow-up-title",(function(){let t=e(this).val();var o=e(".edit-follow-up-container.show").data("follow-up-item");e('.list-group-item[data-follow-up-item="'+o+'"]').find(".fcrc-follow-up-item-title").text(t)}))},deleteFollowUp:function(){e(document).on("click",".delete-follow-up-item",(function(n){n.preventDefault();var i=e(this),s=o.keepButtonState(i),a=i.data("follow-up-item");confirm(t.i18n.confirm_delete_follow_up)&&e.ajax({url:t.ajax_url,type:"POST",data:{action:"fcrc_delete_follow_up",event_key:a},beforeSend:function(){i.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(t){try{"success"===t.status?(e("#follow_up").find("ul.fcrc-follow-up-list").replaceWith(t.follow_up_list),o.displayToast("success",t.toast_header_title,t.toast_body_title)):o.displayToast("error",t.toast_header_title,t.toast_body_title)}catch(e){console.log(e)}},error:function(e,t,o){console.error("Error on AJAX request:",e.responseText)},complete:function(){i.prop("disabled",!1).html(s.html)}})}))},visibilityController:function(t,o){let n=e(t).prop("checked");e(o).toggleClass("d-none",!n),e(t).on("click",(function(){n=e(this).prop("checked"),e(o).toggleClass("d-none",!n)}))},collectLeadSettings:function(){o.visibilityController("#enable_modal_add_to_cart","#collect_lead_modal_settings_trigger"),o.displayModal("#collect_lead_modal_settings_trigger","#collect_lead_modal_settings_container","#collect_lead_modal_settings_close")},selectColor:function(){e(".get-color-selected").on("input",(function(){var t=e(this).val();e(this).closest(".color-container").find(".form-control-color").val(t)})),e(".form-control-color").on("input",(function(){var t=e(this).val();e(this).closest(".color-container").find(".get-color-selected").val(t)})),e(".reset-color").on("click",(function(t){t.preventDefault();var o=e(this).data("color");e(this).closest(".color-container").find(".form-control-color").val(o),e(this).closest(".color-container").find(".get-color-selected").val(o).change()}))},joinotifySettings:function(){o.visibilityController("#enable_joinotify_integration","#fcrc_joinotify_settings_trigger"),o.displayModal("#fcrc_joinotify_settings_trigger","#fcrc_joinotify_settings_container","#fcrc_joinotify_settings_close")},integrationSettings:function(){o.joinotifySettings()},visibilityControllerForCoupons:function(){function t(e,t){let o=e.siblings(".generate-coupon-wrapper").find(".enable-generate-coupon").prop("checked");e.siblings(".generate-coupon-wrapper").toggleClass("d-none",!t),e.siblings(".coupon-preset-wrapper").toggleClass("d-none",!t),e.siblings(".coupon-prefix-wrapper").toggleClass("d-none",!t),e.siblings(".discount-type-wrapper").toggleClass("d-none",!t),e.siblings(".coupon-value-wrapper").toggleClass("d-none",!t),e.siblings(".coupon-allow-free-shipping-wrapper").toggleClass("d-none",!t),e.siblings(".coupon-expire-time-wrapper").toggleClass("d-none",!t),e.siblings(".restrictions-wrapper").toggleClass("d-none",!t),t&&(o?(e.siblings(".coupon-preset-wrapper").addClass("d-none"),e.siblings(".coupon-prefix-wrapper").removeClass("d-none")):(e.siblings(".coupon-preset-wrapper").removeClass("d-none"),e.siblings(".coupon-prefix-wrapper").addClass("d-none")))}e(document).on("change",".enable-send-coupon",(function(){let o=e(this).prop("checked");t(e(this).parent(".enable-send-coupon-wrapper"),o)})),e(".enable-send-coupon").each((function(){let o=e(this).prop("checked"),n=e(this).parent(".enable-send-coupon-wrapper");setTimeout((()=>{t(n,o)}),500)})),e(document).on("change",".enable-generate-coupon",(function(){let t=e(this).prop("checked"),o=e(this).parent(".generate-coupon-wrapper");o.siblings(".coupon-preset-wrapper").toggleClass("d-none",t),o.siblings(".coupon-prefix-wrapper").toggleClass("d-none",!t)})),e(".enable-generate-coupon").each((function(){let t=e(this).prop("checked"),o=e(this).parent(".generate-coupon-wrapper");o.siblings(".coupon-preset-wrapper").toggleClass("d-none",t),o.siblings(".coupon-prefix-wrapper").toggleClass("d-none",!t)}))},emojiPicker:function(){var o=t.i18n.emoji_picker;e(".add-emoji-picker").hasClass("emoji-initialized")||(setTimeout((()=>{e(".add-emoji-picker").emojioneArea({tones:!0,hidePickerOnBlur:!0,recentEmojis:!0,pickerPosition:"bottom",searchPlaceholder:o.placeholder,buttonTitle:o.button_title,filters:{tones:{title:o.filters.tones_title},recent:{title:o.filters.recent_title},smileys_people:{title:o.filters.smileys_people_title},animals_nature:{title:o.filters.animals_nature_title},food_drink:{title:o.filters.food_drink_title},activity:{title:o.filters.activity_title},travel_places:{title:o.filters.travel_places_title},objects:{title:o.filters.objects_title},symbols:{title:o.filters.symbols_title},flags:{title:o.filters.flags_title}}})}),500),e(".add-emoji-picker").addClass("emoji-initialized")),e(document).on("keyup change",".emojionearea-editor",(function(){var t=e(this).html();e(this).closest(".add-emoji-picker").val(t)}))},init:function(){this.activateTabs(),this.saveOptions(),this.addNewFollowUp(),this.editFollowUp(),this.deleteFollowUp(),this.collectLeadSettings(),this.selectColor(),this.integrationSettings(),this.emojiPicker(),this.visibilityControllerForCoupons()}};jQuery(document).ready((function(e){o.init()}))}(jQuery);
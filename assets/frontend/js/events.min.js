!function(e){"use strict";const t=fcrc_events_params;var o={};const c={init:function(){this.collectLead(),"yes"===t.collect_data_from_ip&&this.getUserLocation(),t.is_product&&this.openModal(),"yes"===t.enable_international_phone&&t.is_product&&this.internationalPhone(),this.startPingTracking()},keepButtonState:function(e){var t=e.width(),o=e.height(),c=e.html();return e.width(t),e.height(o),{width:t,height:o,html:c}},openModal:function(){var o=t.triggers_list;e(o).hover((function(t){e("body").hasClass("fcrc-lead-collected")||e("body").hasClass("fcrc-lead-rejected")||"yes"===c.getCookie("fcrc_lead_collected")||e(".fcrc-popup-container.lead-capture-modal").addClass("show")})),e(document).on("click",".fcrc-popup-close",(function(t){t.preventDefault(),e(".fcrc-popup-container.lead-capture-modal").removeClass("show"),e("body").addClass("fcrc-lead-rejected")}))},collectLead:function(){e(document).on("click",".fcrc-trigger-send-lead",(function(n){n.preventDefault();var a=e(this),r=c.keepButtonState(a),i=e(".fcrc-get-first-name").val()||c.getCookie("fcrc_first_name"),s=e(".fcrc-get-last-name").val()||c.getCookie("fcrc_last_name"),l=e(".fcrc-get-phone").val()||c.getCookie("fcrc_phone"),d=e(".fcrc-get-email").val()||c.getCookie("fcrc_email");e.ajax({url:t.ajax_url,type:"POST",data:{action:"fcrc_lead_collected",first_name:i,last_name:s,phone:l,email:d,country_data:JSON.stringify(o)},beforeSend:function(){a.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(o){t.dev_mode&&console.log(o);try{"success"===o.status?(e("body").addClass("fcrc-lead-collected"),e(".fcrc-popup-container.lead-capture-modal").removeClass("show"),c.setCookie("fcrc_cart_id",o.cart_id,7),c.setCookie("fcrc_first_name",i,365),c.setCookie("fcrc_last_name",s,365),c.setCookie("fcrc_phone",l,365),c.setCookie("fcrc_email",d,365),c.setCookie("fcrc_lead_collected","yes",365)):e("body").removeClass("fcrc-lead-collected")}catch(e){console.log(e)}},error:function(){console.log("Error on send lead data")},complete:function(){a.prop("disabled",!1).html(r.html)}})}))},setCookie:function(e,t,o){let c="";if(o){let e=new Date;e.setTime(e.getTime()+24*o*60*60*1e3),c="; expires="+e.toUTCString()}document.cookie=e+"="+encodeURIComponent(t)+c+"; path=/"},getCookie:function(e){let t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.\$?*|{}\(\)\[\]\/+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0},internationalPhone:function(){const e=document.querySelector(".fcrc-input.fcrc-get-phone"),n=window.intlTelInput(e,{loadUtilsOnInit:t.path_to_utils,autoPlaceholder:"aggressive",containerClass:"fcrc-international-phone-selector",initialCountry:"auto",geoIpLookup:function(e,t){const o=c.getCookie("fcrc_phone_country_code");o?e(o):fetch("https://ipapi.co/json").then((function(e){return e.json()})).then((function(t){document.cookie="fcrc_phone_country_code="+t.country_code+"; max-age=604800; path=/",e(t.country_code)})).catch((function(){t("br")}))},i18n:{searchPlaceholder:t.i18n.intl_search_input_placeholder}});setTimeout((()=>{o=n.getSelectedCountryData()}),500)},sendPing:function(){let o=c.getCookie("fcrc_cart_id");o&&e.ajax({url:t.ajax_url,type:"POST",data:{action:"fcrc_cart_ping",cart_id:o,ping:!0},success:function(e){t.dev_mode&&console.log("Ping sent:",e)},error:function(){console.log("Error sending cart ping.")}})},startPingTracking:function(){if(c.getCookie("fcrc_cart_id")){c.sendPing();var e=1e3*t.get_heartbeat_interval;setInterval(c.sendPing,e)}},getUserLocation:function(){fetch("https://ipapi.co/json").then((e=>e.json())).then((e=>{o={country_code:e.country_code,country_name:e.country_name,region:e.region,city:e.city,ip:e.ip},c.setCookie("fcrc_location",JSON.stringify(o),365),c.sendLocationData(o)})).catch((e=>{console.error("Error fetching location:",e)}))},sendLocationData:function(o){let n=c.getCookie("fcrc_cart_id");n&&e.ajax({url:t.ajax_url,type:"POST",data:{action:"fcrc_update_location",cart_id:n,country_data:JSON.stringify(o)},success:function(e){t.dev_mode&&console.log("Location data sent:",e)},error:function(){console.error("Error sending location data.")}})}};jQuery(document).ready((function(e){c.init()}))}(jQuery);
!function(e){"use strict";const o=fcrc_events_params;var t={};const c={keepButtonState:function(e){var o=e.width(),t=e.height(),c=e.html();return e.width(o),e.height(t),{width:o,height:t,html:c}},openModal:function(){var t=o.triggers_list;e(t).hover((function(o){e("body").hasClass("fcrc-lead-collected")||e("body").hasClass("fcrc-lead-rejected")||"yes"===c.getCookie("fcrc_lead_collected")||e(".fcrc-popup-container.lead-capture-modal").addClass("show")})),e(document).on("click",".fcrc-popup-close",(function(o){o.preventDefault(),e(".fcrc-popup-container.lead-capture-modal").removeClass("show"),e("body").addClass("fcrc-lead-rejected")}))},collectLead:function(){e(document).on("click",".fcrc-trigger-send-lead",(function(n){n.preventDefault();var a=e(this),r=c.keepButtonState(a),i=e(".fcrc-get-first-name").val()||c.getCookie("fcrc_first_name"),l=e(".fcrc-get-last-name").val()||c.getCookie("fcrc_last_name"),s=e(".fcrc-get-phone").val()||c.getCookie("fcrc_phone"),d=e(".fcrc-get-email").val()||c.getCookie("fcrc_email"),u=c.getCookie("fcrc_cart_id")||"";e.ajax({url:o.ajax_url,type:"POST",data:{action:"fcrc_lead_collected",first_name:i,last_name:l,phone:s,email:d,country_data:JSON.stringify(t),cart_id:u},beforeSend:function(){a.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm"></span>')},success:function(t){o.dev_mode&&console.log(t);try{"success"===t.status?(e("body").addClass("fcrc-lead-collected"),e(".fcrc-popup-container.lead-capture-modal").removeClass("show"),c.setCookie("fcrc_cart_id",t.cart_id,7),c.setCookie("fcrc_first_name",i,365),c.setCookie("fcrc_last_name",l,365),c.setCookie("fcrc_phone",s,365),c.setCookie("fcrc_email",d,365),c.setCookie("fcrc_lead_collected","yes",365)):e("body").removeClass("fcrc-lead-collected")}catch(e){console.log(e)}},error:function(){console.log("Error on send lead data")},complete:function(){a.prop("disabled",!1).html(r.html)}})}))},setCookie:function(e,o,t){let c="";if(t){let e=new Date;e.setTime(e.getTime()+24*t*60*60*1e3),c="; expires="+e.toUTCString()}document.cookie=e+"="+encodeURIComponent(o)+c+"; path=/"},getCookie:function(e){let o=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.\$?*|{}\(\)\[\]\/+^])/g,"\\$1")+"=([^;]*)"));return o?decodeURIComponent(o[1]):void 0},internationalPhone:function(){const e=document.querySelector(".fcrc-input.fcrc-get-phone");if(!e)return void(o.dev_mode&&console.warn("fcrc-get-phone input not found"));const n=window.intlTelInput(e,{loadUtilsOnInit:o.path_to_utils,autoPlaceholder:"aggressive",containerClass:"fcrc-international-phone-selector",initialCountry:"auto",geoIpLookup:function(e,o){const t=c.getCookie("fcrc_phone_country_code");t?e(t):fetch("https://ipapi.co/json").then((function(e){return e.json()})).then((function(o){document.cookie="fcrc_phone_country_code="+o.country_code+"; max-age=604800; path=/",e(o.country_code)})).catch((function(){o("br")}))},i18n:{searchPlaceholder:o.i18n.intl_search_input_placeholder}});setTimeout((()=>{t=n.getSelectedCountryData()}),500)},getUserLocation:function(){var e=c.getCookie("fcrc_location");if(e)return(e=JSON.parse(e)).cache=!0,void c.sendLocationData(e);fetch("https://ipapi.co/json").then((e=>e.json())).then((e=>{t={country_code:e.country_code,country_name:e.country_name,region:e.region,city:e.city,ip:e.ip},c.setCookie("fcrc_location",JSON.stringify(t),7),c.sendLocationData(t)})).catch((e=>{console.error("Error fetching location:",e)}))},sendLocationData:function(t){let n=c.getCookie("fcrc_cart_id");n&&e.ajax({url:o.ajax_url,type:"POST",data:{action:"fcrc_update_location",cart_id:n,country_data:JSON.stringify(t)},success:function(e){o.dev_mode&&console.log("Location data sent:",e)},error:function(){console.error("Error sending location data.")}})},init:function(){this.collectLead(),"yes"===o.collect_data_from_ip&&this.getUserLocation(),o.is_product&&this.openModal(),"yes"===o.enable_international_phone&&o.is_product&&this.internationalPhone()}};jQuery(document).ready((function(e){c.init()}))}(jQuery);